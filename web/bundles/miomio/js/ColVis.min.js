(function($){ColVis=function(oDTSettings)
{if(!this.CLASS||this.CLASS!="ColVis")
{alert("Warning: ColVis must be initialised with the keyword 'new'");}
this.s={"dt":null,"activate":"click","buttonText":"Show / hide columns","hidden":true,"aiExclude":[]};this.dom={"wrapper":null,"button":null,"collection":null,"background":null,"catcher":null,"buttons":[]};this.s.dt=oDTSettings;this._fnConstruct();return this;};ColVis.prototype={"_fnConstruct":function()
{this._fnApplyCustomisation();var that=this;this.dom.wrapper=document.createElement('div');this.dom.wrapper.className="ColVis TableTools";this.dom.button=this._fnDomBaseButton(this.s.buttonText);this.dom.wrapper.appendChild(this.dom.button);this.dom.catcher=this._fnDomCatcher();this.dom.collection=this._fnDomCollection();this.dom.background=this._fnDomBackground();this._fnAddButtons();this.s.dt.aoDrawCallback.push({"fn":function(){that._fnDrawCallback.call(that);},"sName":"ColVis"});},"_fnApplyCustomisation":function()
{if(typeof this.s.dt.oInit.oColVis!='undefined')
{var oConfig=this.s.dt.oInit.oColVis;if(typeof oConfig.activate!='undefined')
{this.s.activate=oConfig.activate;}
if(typeof oConfig.buttonText!='undefined')
{this.s.buttonText=oConfig.buttonText;}
if(typeof oConfig.aiExclude!='undefined')
{this.s.aiExclude=oConfig.aiExclude;}}},"_fnDrawCallback":function()
{var aoColumns=this.s.dt.aoColumns;for(var i=0,iLen=aoColumns.length;i<iLen;i++)
{if(this.dom.buttons[i]!==null)
{if(aoColumns[i].bVisible)
{$('input',this.dom.buttons[i]).attr('checked','checked');}
else
{$('input',this.dom.buttons[i]).removeAttr('checked');}}}},"_fnAddButtons":function()
{var
nButton,sExclude=","+this.s.aiExclude.join(',')+",";for(var i=0,iLen=this.s.dt.aoColumns.length;i<iLen;i++)
{if(sExclude.indexOf(","+i+",")==-1)
{nButton=this._fnDomColumnButton(i);this.dom.buttons.push(nButton);this.dom.collection.appendChild(nButton);}
else
{this.dom.buttons.push(null);}}},"_fnDomColumnButton":function(i)
{var
that=this,oColumn=this.s.dt.aoColumns[i],nButton=document.createElement('button'),nSpan=document.createElement('span');nButton.className=!this.s.dt.bJUI?"ColVis_Button TableTools_Button":"ColVis_Button TableTools_Button ui-button ui-state-default";nButton.appendChild(nSpan);$(nSpan).html('<span class="ColVis_radio"><input type="checkbox"></span>'+'<span class="ColVis_title">'+oColumn.sTitle+'</span>');$(nButton).click(function(e){var showHide=$('input',this).attr('checked')===true?false:true;if(e.target.nodeName.toLowerCase()=="input")
{showHide=$('input',this).attr('checked');}
that.s.dt.oInstance.fnSetColumnVis(i,showHide);});return nButton;},"_fnDomBaseButton":function(text)
{var
that=this,nButton=document.createElement('button'),nSpan=document.createElement('span'),sEvent=this.s.activate=="mouseover"?"mouseover":"click";nButton.className=!this.s.dt.bJUI?"ColVis_Button TableTools_Button":"ColVis_Button TableTools_Button ui-button ui-state-default";nButton.appendChild(nSpan);nSpan.innerHTML=text;$(nButton).bind(sEvent,function(e){that._fnCollectionShow();e.preventDefault();});return nButton;},"_fnDomCollection":function()
{var that=this;var nHidden=document.createElement('div');nHidden.style.display="none";nHidden.className=!this.s.dt.bJUI?"ColVis_collection TableTools_collection":"ColVis_collection TableTools_collection ui-buttonset ui-buttonset-multi";nHidden.style.position="absolute";$(nHidden).css('opacity',0);return nHidden;},"_fnDomCatcher":function()
{var
that=this,nCatcher=document.createElement('div');nCatcher.className="ColVis_catcher TableTools_catcher";$(nCatcher).click(function(){that._fnCollectionHide.call(that,null,null);});return nCatcher;},"_fnDomBackground":function()
{var that=this;var nBackground=document.createElement('div');nBackground.style.position="absolute";nBackground.style.left="0px";nBackground.style.top="0px";nBackground.className="TableTools_collectionBackground";$(nBackground).css('opacity',0);$(nBackground).click(function(){that._fnCollectionHide.call(that,null,null);});if(this.s.activate=="mouseover")
{$(nBackground).mouseover(function(){that.s.overcollection=false;that._fnCollectionHide.call(that,null,null);});}
return nBackground;},"_fnCollectionShow":function()
{var that=this;var oPos=$(this.dom.button).offset();var nHidden=this.dom.collection;var nBackground=this.dom.background;var iDivX=parseInt(oPos.left,10);var iDivY=parseInt(oPos.top+$(this.dom.button).outerHeight(),10);nHidden.style.left=iDivX+"px";nHidden.style.top=iDivY+"px";nHidden.style.display="block";$(nHidden).css('opacity',0);var iWinHeight=$(window).height(),iDocHeight=$(document).height(),iWinWidth=$(window).width(),iDocWidth=$(document).width();nBackground.style.height=((iWinHeight>iDocHeight)?iWinHeight:iDocHeight)+"px";nBackground.style.width=((iWinWidth<iDocWidth)?iWinWidth:iDocWidth)+"px";var oStyle=this.dom.catcher.style;oStyle.height=$(this.dom.button).outerHeight()+"px";oStyle.width=$(this.dom.button).outerWidth()+"px";oStyle.top=oPos.top+"px";oStyle.left=iDivX+"px";document.body.appendChild(nBackground);document.body.appendChild(nHidden);document.body.appendChild(this.dom.catcher);var iDivWidth=$(nHidden).outerWidth();var iDivHeight=$(nHidden).outerHeight();if(iDivX+iDivWidth>iDocWidth)
{nHidden.style.left=(iDocWidth-iDivWidth)+"px";}
if(iDivY+iDivHeight>iDocHeight)
{nHidden.style.top=(iDivY-iDivHeight-$(nButton).outerHeight())+"px";}
setTimeout(function(){$(nHidden).animate({"opacity":1},500);$(nBackground).animate({"opacity":0.1},500);},10);this.s.hidden=false;},"_fnCollectionHide":function()
{var that=this;if(!this.s.hidden&&this.dom.collection!==null)
{this.s.hidden=true;$(this.dom.collection).animate({"opacity":0},500,function(e){this.style.display="none";});$(this.dom.background).animate({"opacity":0},500,function(e){document.body.removeChild(that.dom.background);document.body.removeChild(that.dom.catcher);});}}};ColVis.prototype.CLASS="ColVis";ColVis.VERSION="1.0.1";ColVis.prototype.VERSION=ColVis.VERSION;if(typeof $.fn.dataTable=="function"&&typeof $.fn.dataTableExt.fnVersionCheck=="function"&&$.fn.dataTableExt.fnVersionCheck('1.7.0'))
{$.fn.dataTableExt.aoFeatures.push({"fnInit":function(oDTSettings){var tt=new ColVis(oDTSettings);return tt.dom.wrapper;},"cFeature":"C","sFeature":"ColVis"});}
else
{alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download");}})(jQuery);