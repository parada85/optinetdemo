$(document).ready(function(){var A=0;$("#añadirapedido").live("click",function(){var L=$("td",this.parentNode.parentNode);var F=tablapedido.fnGetPosition(this.parentNode.parentNode);var B=$(L[0]).text();var D=$(L[1]).text();var K=parseInt($(L[2]).text());var C=parseFloat($(L[6]).text());var J=parseInt(this.parentNode.firstChild.value);var I;var H=0;if(J==0||this.parentNode.firstChild.value==""||isNaN(this.parentNode.firstChild.value)){$("#error").wijdialog("open")}else{var G=$("td",tabla4.fnGetNodes());for(var E=0;E<parseInt(G.length);E=E+6){if($(G[E]).text()==B){H=1;I=parseInt($(G[E+2]).text());tabla4.fnUpdate(I+J+" unidad/es",E/6,2);tabla4.fnUpdate((I+J)*C+" €",E/6,4);var M=$("#totalventa").val();$("#totalventa").html(M+(I+J)*C)}}if(H==0){A=J*C;A=Math.round(A*100)/100;tabla4.fnAddData([B,D,J+" unidad/es",C+" €",A+" €",'<div class="sumar1">Sumar</div><div class="restar1">Restar</div><div class="eliminar1">Eliminar</div>']);M=parseFloat($("#totalventa").html());A=M+(J)*C;A=Math.round(A*100)/100;$("#totalventa").html(A);$(".sumar1").button({icons:{primary:"ui-icon-plusthick"}});$(".restar1").button({icons:{primary:"ui-icon-minusthick"}});$(".eliminar1").button({icons:{primary:"ui-icon-trash"}})}}this.parentNode.firstChild.value=""});$("#añadirreserva").live("click",function(){var M=$("td",this.parentNode.parentNode);var G=tabla3.fnGetPosition(this.parentNode.parentNode);var C=$(M[0]).text();var E=$(M[1]).text();var L=parseInt($(M[2]).text());var B=parseInt($(M[3]).text());var D=parseFloat($(M[5]).text());var K=parseFloat(this.parentNode.firstChild.value);var J;var I=0;if(this.parentNode.firstChild.value==""||isNaN(this.parentNode.firstChild.value)||K<L){$("#error").wijdialog("open")}else{var H=$("td",tabla4.fnGetNodes());for(var F=0;F<parseInt(H.length);F=F+7){if($(H[F]).text()==C){I=1;J=parseFloat($(H[F+2]).text());A=(J+K)*D;A=Math.round(A*100)/100;tabla4.fnUpdate(J+K+" unidad/es",F/7,2);tabla4.fnUpdate(A+" €",F/7,4);tabla3.fnUpdate(J+K+" unidad/es",G,4);N=parseFloat($("#totalventa").html());A=N+(K)*D;A=Math.round(A*100)/100;$("#totalventa").html(A)}}if(I==0){tabla3.fnUpdate(B+K+" unidad/es",G,4);A=K*D;A=Math.round(A*100)/100;tabla4.fnAddData([C,E,K+" unidad/es",D+" €",A+" €",'<div class="sumarreserva">Sumar</div><div class="restarreserva">Restar</div><div class="eliminarreserva">Eliminar</div>']);var N=$("#totalventa").text();A=Math.round((parseFloat(N)+A)*100)/100;$("#totalventa").html(A);$(".sumarreserva").button({icons:{primary:"ui-icon-plusthick"}});$(".restarreserva").button({icons:{primary:"ui-icon-minusthick"}});$(".eliminarreserva").button({icons:{primary:"ui-icon-trash"}})}}this.parentNode.firstChild.value=""});$("#añadir").live("click",function(){var L=$("td",this.parentNode.parentNode);var F=tabla1.fnGetPosition(this.parentNode.parentNode);var B=$(L[0]).text();var D=$(L[1]).text();var K=parseInt($(L[2]).text());var C=parseFloat($(L[5]).text());var I=parseInt(this.parentNode.firstChild.value);var H;var G=0;if(I<=0||K<I||this.parentNode.firstChild.value==""||isNaN(this.parentNode.firstChild.value)){$("#error").wijdialog("open")}else{var J=$("td",tabla2.fnGetNodes());for(var E=0;E<parseInt(J.length);E=E+6){if($(J[E]).text()==B){G=1;H=parseInt($(J[E+2]).text());tabla2.fnUpdate(H+I+" unidad/es",E/11,2);A=(H+I)*C;A=Math.round(A*100)/100;tabla2.fnUpdate(A+" €",E/11,4);tabla1.fnUpdate(K-I+" unidad/es",F,2);M=parseFloat($("#totalventa").html());A=M+(I)*C;A=Math.round(A*100)/100;$("#totalventa").html(A)}}if(G==0){tabla1.fnUpdate(K-I+" unidad/es",F,2);A=I*C;A=Math.round(A*100)/100;tabla2.fnAddData([B,D,I+" unidad/es",C+" €",A+" €",'<div class="sumar">Sumar</div><div class="restar">Restar</div><div class="eliminar">Eliminar</div>']);var M=$("#totalventa").text();A=Math.round((parseFloat(M)+A)*100)/100;$("#totalventa").html(A);$(".sumar").button({icons:{primary:"ui-icon-plusthick"}});$(".restar").button({icons:{primary:"ui-icon-minusthick"}});$(".eliminar").button({icons:{primary:"ui-icon-trash"}})}}this.parentNode.firstChild.value=""});$(".eliminar").live("click",function(){var D=$("td",this.parentNode.parentNode);var H=parseInt($(D[2]).text());var G=parseFloat($(D[3]).text());var I=parseInt($(D[0]).text());var E=$("td",tabla1.fnGetNodes());for(var C=0;C<parseInt(E.length);C=C+8){if($(E[C]).text()==I){stock=parseInt($(E[C+2]).text());tabla1.fnUpdate(stock+H+" unidad/es",C/8,2);var F=$("#totalventa").text();A=Math.round((parseFloat(F)-H*G)*100)/100;$("#totalventa").html(A)}}var B=tabla2.fnGetPosition(this.parentNode);tabla2.fnDeleteRow(B[0])});$(".restar").live("click",function(){var E=$("td",this.parentNode.parentNode);var C=tabla2.fnGetPosition(this.parentNode.parentNode);tabla2.fnUpdate(parseInt($(E[2]).text())-1+" unidad/es",C,2);var H=parseInt($(E[0]).text());var F=$("td",tabla1.fnGetNodes());for(var D=0;D<parseInt(F.length);D=D+8){if($(F[D]).text()==H){stock=parseInt($(F[D+2]).text());tabla1.fnUpdate(stock+1+" unidad/es",D/8,2);A=parseFloat($(E[4]).text())-parseFloat($(E[3]).text());A=Math.round(A*100)/100;tabla2.fnUpdate(A+" €",C,4);var G=$("#totalventa").text();var B=parseFloat($(E[3]).text());A=Math.round((parseFloat(G)-B)*100)/100;$("#totalventa").html(A)}}if(parseInt($(E[2]).text())==0){tabla2.fnDeleteRow(C)}});$(".sumar").live("click",function(){var E=$("td",this.parentNode.parentNode);var C=tabla2.fnGetPosition(this.parentNode.parentNode);var H=parseInt($(E[0]).text());var F=$("td",tabla1.fnGetNodes());for(var D=0;D<parseInt(F.length);D=D+8){if($(F[D]).text()==H){stock=parseInt($(F[D+2]).text());if(stock>0){tabla1.fnUpdate(stock-1+" unidad/es",D/8,2);tabla2.fnUpdate(parseInt($(E[2]).text())+1+" unidad/es",C,2);A=parseFloat($(E[4]).text())+parseFloat($(E[3]).text());A=Math.round(A*100)/100;tabla2.fnUpdate(A+" €",C,4);var G=$("#totalventa").text();var B=parseFloat($(E[3]).text());A=Math.round((parseFloat(G)+B)*100)/100;$("#totalventa").html(A)}}}});$(".eliminarreserva").live("click",function(){var H=$("td",this.parentNode.parentNode);var G=parseInt($(H[2]).text());var D=parseFloat($(H[3]).text());var C=parseInt($(H[0]).text());var I=$("td",tabla3.fnGetNodes());for(var E=0;E<parseInt(I.length);E=E+8){if($(I[E]).text()==C){var B=parseInt($(I[E+3]).text());tabla3.fnUpdate(B-G+" unidad/es",E/8,4);var J=$("#totalventa").text();A=Math.round((parseFloat(J)-G*D)*100)/100;$("#totalventa").html(A)}}var F=tabla4.fnGetPosition(this.parentNode);tabla4.fnDeleteRow(F[0])});$(".restarreserva").live("click",function(){var D=$("td",this.parentNode.parentNode);var C=tabla4.fnGetPosition(this.parentNode.parentNode);tabla4.fnUpdate(parseInt($(D[2]).text())-1+" unidad/es",C,2);var H=parseInt($(D[0]).text());var E=$("td",tabla3.fnGetNodes());for(var F=0;F<parseInt(E.length);F=F+8){if($(E[F]).text()==H){stockreservado=parseInt($(E[F+3]).text());tabla3.fnUpdate(stockreservado-1+" unidad/es",F/8,4);A=parseFloat($(D[4]).text())-parseFloat($(D[3]).text());A=Math.round(A*100)/100;tabla4.fnUpdate(A+" €",C,4);var G=$("#totalventa").text();var B=parseFloat($(D[3]).text());A=Math.round((parseFloat(G)-B)*100)/100;$("#totalventa").html(A)}}if(parseInt($(D[2]).text())==0){tabla4.fnDeleteRow(C)}});$(".sumarreserva").live("click",function(){var D=$("td",this.parentNode.parentNode);var C=tabla4.fnGetPosition(this.parentNode.parentNode);tabla4.fnUpdate(parseInt($(D[2]).text())+1+" unidad/es",C,2);var H=parseInt($(D[0]).text());var E=$("td",tabla3.fnGetNodes());for(var F=0;F<parseInt(E.length);F=F+8){if($(E[F]).text()==H){stockreservado=parseInt($(E[F+3]).text());tabla3.fnUpdate(stockreservado+1+" unidad/es",F/8,4);A=parseFloat($(D[4]).text())+parseFloat($(D[3]).text());A=Math.round(A*100)/100;tabla4.fnUpdate(A+" €",C,4);var G=$("#totalventa").text();var B=parseFloat($(D[3]).text());A=Math.round((parseFloat(G)+B)*100)/100;$("#totalventa").html(A)}}});$(".eliminar1").live("click",function(){var B=tabla4.fnGetPosition(this.parentNode);tabla4.fnDeleteRow(B[0]);var C=$("td",this.parentNode.parentNode);var F=parseInt($(C[2]).text());var E=parseFloat($(C[3]).text());var D=$("#totalventa").text();A=Math.round((parseFloat(D)-F*E)*100)/100;$("#totalventa").html(A)});$(".restar1").live("click",function(){var D=$("td",this.parentNode.parentNode);var C=tabla4.fnGetPosition(this.parentNode.parentNode);tabla4.fnUpdate(parseInt($(D[2]).text())-1+" unidad/es",C,2);A=parseFloat($(D[4]).text())-parseFloat($(D[3]).text());A=Math.round(A*100)/100;tabla4.fnUpdate(A+" €",C,4);var E=$("#totalventa").text();var B=parseFloat($(D[3]).text());A=Math.round((parseFloat(E)-B)*100)/100;$("#totalventa").html(A);if(parseInt($(D[2]).text())==0){tabla4.fnDeleteRow(C)}});$(".sumar1").live("click",function(){var D=$("td",this.parentNode.parentNode);var C=tabla4.fnGetPosition(this.parentNode.parentNode);tabla4.fnUpdate(parseInt($(D[2]).text())+1+" unidad/es",C,2);A=parseFloat($(D[4]).text())+parseFloat($(D[3]).text());A=Math.round(A*100)/100;tabla4.fnUpdate(A+" €",C,4);var E=$("#totalventa").text();var B=parseFloat($(D[3]).text());A=Math.round((parseFloat(E)+B)*100)/100;$("#totalventa").html(A)})});