$(document).ready(function(){if($.cookie("cssmio")){$("#hojaestilo").attr("href",$.cookie("cssmio"))}$(".tema").click(function(){$("#hojaestilo").attr("href",$(this).attr("rel"));$.cookie("cssmio",$(this).attr("rel"),{expires:7,path:"/"});return false});$("#mio_miobundle_medicotype_color").minicolors({theme:"bootstrap",swatchPosition:"right"});$("#pickers").datepicker();$(".notificacion,.notificacionerror").show();$(".notificacion").addClass("ui-state-highlight ui-corner-all");$(".notificacionerror").addClass("ui-state-error ui-corner-all");setTimeout(function(){$(".notificacion,.notificacionerror").hide("fade")},5000);$("#sortable1, #sortable2").sortable({connectWith:".connectedSortable"}).disableSelection();if($.browser.webkit){$("input").attr("autocomplete","off")}$("#sortable2").bind("sortreceive",function(C,D){var A=D.item.attr("id");var B=$("#fam2").val();$.ajax({url:Routing.generate("moverfamiliaajax1"),data:{id_producto:A,id_familia:B}});$("#contarproductofam2").text(parseInt($("#contarproductofam2").text())+1);$("#contarproductofam1").text(parseInt($("#contarproductofam1").text())-1)});$("#sortable1").bind("sortreceive",function(C,D){var A=D.item.attr("id");var B=$("#fam1").val();$.ajax({url:Routing.generate("moverfamiliaajax1"),data:{id_producto:A,id_familia:B}});$("#contarproductofam1").text(parseInt($("#contarproductofam1").text())+1);$("#contarproductofam2").text(parseInt($("#contarproductofam2").text())-1)});$("#tabs,#emptabs").tabs();$("#menu1").wijmenu({orientation:"horizontal"});$(".formulario > div > div > input").wijtextbox();$(".formulario > div > div").addClass("ui-widget-header");$(".izquierdo div").addClass("ui-widget-header");$(".derecho div").addClass("ui-widget-header");$("#otros div").addClass("ui-widget-header");$(".formulario1 > div > span > div > input").wijtextbox();$("[title]").wijtooltip();$(".botoncarro").button({icons:{primary:"ui-icon-cart"}});$(".boton").button();$(".botoncheck").button({icons:{primary:"ui-icon-check"}});$(".botonolvidada").button({icons:{primary:"ui-icon-key"}});$(".botonvolver").button({icons:{primary:"ui-icon-arrowreturnthick-1-w"}});$(".botoneditar").button({icons:{primary:"ui-icon-pencil"}});$(".botoneliminar").button({icons:{primary:"ui-icon-trash"}});$(".botondocumento").button({icons:{primary:"ui-icon-document"}});$(".botondesactivado").button({disabled:true});$(":input[type='checkbox']").wijcheckbox();$(".lista").wijdropdown();$(".select_filter").wijdropdown();$("#guardar").live("click",function(){var A=tabla2.fnSettings().fnRecordsTotal();if($(".entregado input").is(":visible")){if(A==0||isNaN($(".entregado input").val())||$(".entregado input").val()==""||parseFloat($(".entregado input").val())<parseFloat($("#totalventa").html())){$("#error").wijdialog("open")}else{$("#confirmar").wijdialog("open")}}else{if(A==0){$("#error").wijdialog("open")}else{$("#confirmar").wijdialog("open")}}});$("#guardarpedido").live("click",function(){var A=tabla4.fnSettings().fnRecordsTotal();if(A==0){$("#error").wijdialog("open")}else{$("#confirmar23").wijdialog("open")}});$("#passolvidado").live("click",function(){url=Routing.generate("passolvidado");window.location=url});$("#enviarpass").live("click",function(){var A=$("#mail").val();if(A){$("#ajax-loader").show();$.ajax({url:Routing.generate("enviarmailpass"),data:{mail:A},success:function(B){setTimeout(function(){$("#ajax-loader").hide();if(B==1){$("#errorlogin").text("Se ha mandado un nuevo email con la contraseÃ±a")}else{$("#errorlogin").text("El email introducido es incorrecto")}},1000)}})}});$("#bandera1").live("click",function(){window.location=Routing.generate("cambiarlocale",{idioma:"en"})});$("#bandera0").live("click",function(){window.location=Routing.generate("cambiarlocale",{idioma:"es"})});$("#guardarreserva").live("click",function(){var A=$("#adelanto").val();var C=tabla4.fnSettings().fnRecordsTotal();var B=parseFloat($("#totalventa").html());if(isNaN(A)||C==0||A==""||A<0||A>B||parseFloat($(".entregado input").val())<A){$("#error").wijdialog("open")}else{$("#confirmar8").wijdialog("open")}});$("#guardarapartado").live("click",function(){var A=$("#adelanto").val();var C=tabla2.fnSettings().fnRecordsTotal();var B=parseFloat($("#totalventa").html());if(isNaN(A)||C==0||A==""||A<0||A>B||A>parseFloat($(".entregado input").val())){$("#error").wijdialog("open")}else{$("#confirmar29").wijdialog("open")}});$(".convertiraventa").live("click",function(){var A=$("td",this.parentNode.parentNode);var C=parseFloat($(A[4]).text());var E=parseFloat($(A[5]).text());var D=parseInt($(A[0]).text());var B=C-E;B=Math.round(B*100)/100;$("#totaldialogo").html(B);if(B==0){$(".entregado1").hide();$("#formapagoreserva").hide()}$("#idreserva").html(D);$("#dialogoconvertirventa").wijdialog("open")});$("#contacto").live("click",function(){$("#mensajecontacto").wijdialog("open")});$("#productomostrar").change(function(){tablalistaproductos.fnFilter($(this).val(),null,false,false,false,false);tablalistaproductos.fnDraw()});$(".operacionescliente").change(function(){window.location=$(this).val()});$("#fam1").change(function(){id_familia=$(this).val();seleccionado=$("#fam2").find("option:selected").val();var A='<option value="'+$("#fam2").find("option:selected").val()+'">'+$("#fam2").find("option:selected").text()+"</option>";$("#fam2").find("option").remove().end().append($("#fam1").html());$("#fam2").find("option").end().append(A);$("#fam2 option[value="+seleccionado+"]").attr("selected",true);var B=$("#fam1 option:selected").val();$("#fam2 option[value='"+B+"']").remove();$.getJSON(Routing.generate("moverfamiliaajax",{id:id_familia}),function(C){$("#sortable1 div").remove();$.each(C,function(D,E){$("#sortable1").append('<div class="gelou" id="'+E.id+'"> '+E.descripcion+"</div>");$(".gelou").button()});$("#contarproductofam1").text(C.length)});$("#fam2,#fam1").wijdropdown("refresh")});$("#fam2 option:last").remove();$("#fam1 option:first").remove();$("#fam2 option:first,#fam1 option:last").attr("selected",true);$("#fam2,#fam1").wijdropdown("refresh");$("#fam2").change(function(){id_familia=$(this).val();seleccionado=$("#fam1").find("option:selected").val();var A='<option value="'+$("#fam1").find("option:selected").val()+'">'+$("#fam1").find("option:selected").text()+"</option>";$("#fam1").find("option").remove().end().append($("#fam2").html());$("#fam1").find("option").end().append(A);$("#fam1 option[value="+seleccionado+"]").attr("selected",true);var B=$("#fam2 option:selected").val();$("#fam1 option[value='"+B+"']").remove();$.getJSON(Routing.generate("moverfamiliaajax",{id:id_familia}),function(C){$("#sortable2 div").remove();$.each(C,function(D,E){$("#sortable2").append('<div class="gelou" id='+E.id+"> "+E.descripcion+"</div>");$(".gelou").button()});$("#contarproductofam2").text(C.length)});$("#fam2,#fam1").wijdropdown("refresh")});$(".avisada").live("click",function(){var A=$("td",this.parentNode.parentNode);var B=$(A[0]).text();$.ajax({url:Routing.generate("avisada",{id:B})});setTimeout(function(){window.location=Routing.generate("listareserva")},1000)});$(".vervacaciones").live("click",function(){$("#dialogovacaciones").wijdialog("open");tablapermisos1.fnReloadAjax(Routing.generate("listarpermisos",{id:$(this).attr("id")}));$("#tablapermisosdiv").show();var A=TableTools.fnGetInstance("tablapermisos1");A.fnResizeButtons()});$(".recepcionar").live("click",function(){momentoActual=new Date();var E=momentoActual.getHours();var M=momentoActual.getMinutes();var C=momentoActual.getSeconds();var O=momentoActual.getDate();var K=momentoActual.getMonth()+1;var G=new String(O);if(G.length==1){O="0"+O}var N=new String(K);if(N.length==1){K="0"+K}var B=new String(C);if(B.length==1){C="0"+C}var J=new String(M);if(J.length==1){M="0"+M}var A=new String(E);if(A.length==1){E="0"+E}var F=O+"/"+K+"/"+momentoActual.getFullYear()+" "+E+":"+M+":"+C;var L=$("td",this.parentNode.parentNode);var D=$(L[0]).text();var H=$("#chivatoempleado").text();$.ajax({url:Routing.generate("recepcion"),data:{id:D}});var I=listapedido.fnGetPosition(this.parentNode.parentNode);listapedido.fnUpdate(F,I,3);listapedido.fnUpdate(H,I,6)});$("#validararqueo").live("click",function(){var D=0;var E=0;var A=0;var C=0;var B=0;arreglo=new Array(0,500,200,100,50,20,10,5,0.01,0.02,0.05,0.1,0.2,0.5,1,2);$("#billetes :input,#monedas :input").each(function(){if($(this).val()==""||isNaN($(this).val())){$("#camposvacios").wijdialog("open");A=1;return false}else{D+=parseInt($(this).val())*arreglo[C];C=C+1}});if(A!=1){$.getJSON(Routing.generate("confirmararqueo"),function(F){B=Math.abs(F.sum-D);if(B<1&&F.boletas==parseInt($("#boleta").val())){$.ajax({url:Routing.generate("guardararqueo"),data:{efectivo:F.sum,boletas:F.boletas,efectivocontado:D,boletascontadas:$("#boleta").val(),confirmado:"si"}});$(".notificacion1").addClass("notificacion ui-state-highlight ui-corner-all").show();$("#validararqueo").button({disabled:true});setTimeout(function(){$(".notificacion1").hide("fade")},5000)}else{$("#confirmar28").data("sum1",F.sum);$("#confirmar28").data("sum",D);$("#confirmar28").data("boletas",$("#boleta").val());$("#confirmar28").data("boletas1",F.boletas);$("#confirmar28").wijdialog("open")}})}});$("#botondevolver").live("click",function(){$("#confirmardevolver").wijdialog("open")});$(".fancybox").fancybox({type:"iframe"});$(".th").click();$(".th1").click().click();$("#formapago,#formapagoreserva").change(function(){var A=$(this).find("option:selected").val();if(A=="efectivo"){$(".entregado,.entregado1").show("slide");$("#msgconvertir").show("slide")}else{$(".entregado,.entregado1").hide("drop");$("#msgconvertir").hide("drop")}});$("#adelanto").keyup(function(){$(".entregado input").val(this.value)});$(".entregado1 input").keyup(function(){if(parseFloat(this.value)>parseFloat($("#totaldialogo").html())){var A=this.value-$("#totaldialogo").html();A=Math.round(A*100)/100;$("#devolucioncliente").html(A);$("#msgconvertir").show()}else{$("#msgconvertir").hide()}});$(".todoscambios").live("click",function(){window.location=Routing.generate("cambios",{id:0})})});